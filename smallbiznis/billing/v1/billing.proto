syntax = "proto3";

package smallbiznis.billing.v1;

option go_package = "github.com/smallbiznis/go-genproto/smallbiznis/billing/v1;billingv1";

import "google/protobuf/timestamp.proto";

// TriggerBillingRequest asks the platform to evaluate a subscription for a
// billing period. Downstream services emit events such as
// billing.rating.completed.v1 and billing.invoice.created.v1.
message TriggerBillingRequest {
  // Tenant that owns the subscription.
  string tenant_id = 1;
  // Subscription to rate and invoice.
  string subscription_id = 2;
  // Billing window start timestamp.
  google.protobuf.Timestamp period_start = 3;
  // Billing window end timestamp.
  google.protobuf.Timestamp period_end = 4;
}

// TriggerBillingResponse confirms that a billing run was accepted.
message TriggerBillingResponse {
  bool accepted = 1;
}

// BillingService coordinates the billing pipeline (usage → rating → invoice).
service BillingService {
  // Trigger a billing cycle for a subscription. Typically invoked by schedulers
  // or event handlers after a period closes.
  rpc TriggerBilling(TriggerBillingRequest) returns (TriggerBillingResponse);
}
